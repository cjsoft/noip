# 2368 字符串重排   
### 时间限制： 2 s     空间限制： 256000 KB     题目等级： 大师  
## 题目描述：  

<pre>
对于两个字符串 A = a1a2…an和 B = b1b2…
</pre>
  
  
## 输入描述：  

<pre>
输入文件的第一行包含两个整数 n和q，表示字符串和附加任务的数量，中  
间用一个空格隔开。   
接下来 n行，描述字符串，其中第 i 行包含一个字符串 Si。   
接下来 q行，描述附加任务，其中第 i 行包含两个整数Xi和Yi，中间用一个  
空格隔开。
</pre>
  
  
## 输出描述：  

<pre>
第一行包含一个非负整数W(PG*)
第二行包含 n个用一个空格隔开的正整数，表示一个 1到n的排列PB*
</pre>
  
  
## 样例输入：  

<pre><code>
4 6   
a   
b   
abc   
bc   
1 2   
1 3   
3 1   
4 2   
2 4   
2 4
</code></pre>
  
  
## 输出输出：  

<pre><code>
2   
3 1 2 4
</code></pre>
  
  
## 数据范围及提示：  

<pre>
对于 10%的数据，n ≤ 10，q = 1， 每个字符串的长度不超过 50；   
对于 20%的数据，n ≤ 50，q = 1， 每个字符串的长度不超过 50；   
对于 50%的数据，n ≤ 1000，q ≤ 1000， 每个字符串的长度不超过 1000；   
对于 70%的数据，任意字符串不为其他任何一个字符串的前缀；   
对于100%的数据， n ≤ 40 000， q ≤ 100 000， 每个字符串的长度不超过10 000；   
对于 100%的数据，所有字符串的长度和不超过 200000。
</pre>
  
  
***  

##### AC: 0  
##### WA: 10  
##### TLE: 0  
##### MLE: 0  
##### RE: 1  
