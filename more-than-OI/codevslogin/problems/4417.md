# 4417 货车运输   
### 时间限制： 2 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 32000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 钻石  
## 题目描述：  

<pre>
    众所周知，一条完整的产业链是由许多环节构成，只有完成了某个环节才能下一个环节，必须先完成的环节成为该环节的子环节。M国最大的企业的产业链十分有趣，除了第一个环节外，每个环节有且仅有一个子环节。现在明明当上了该公司的一名货车司机。明明拿到了M国的地图，M国共有n个城镇，m条双向道路。每一环节都在一个城镇中进行，且同一个城镇最多进行一个环节。每一个环节都需要一定重量的原材，供应原材料的仓库也坐落在某几个互不相同的城镇。明明的任务是用货车将仓库中的材料依次运往各个环节所在的城镇。明明在运输过程中可经过一个仓库多次但只能从每一个仓库中装载一次原材料。货车载重量及仓库储量不限。运输途中空货车消耗的费用为路程，载重货车消耗的费用为货车载重量乘以路程。明明想知道他是否能完成任务，如果能完成，那么所消耗的最小费用为多少？如果不能完成，那么最多完成多少环节？（明明可选择任意一个城镇作为出发点）。  

</pre>
  
  
## 输入描述：  

<pre>
    输入文件第一行包含两个正整数n，m，k，p分别代表M国城镇数，道路数，产业链所包含的环节数及仓库数量。    接下来m行，每行三个数x，y，z，表示x城镇到y城镇有一条长度为z的双向道路。    接下来k行，每行两个正整数v，w。代表第v个城镇有一个环节需要完成，该环节需要重量为w材料。输入顺序即为环节完成的先后顺序。    接下来1行，包含P个整数，分别代表仓库所在的城镇编号。  

</pre>
  
  
## 输出描述：  

<pre>
    输出文件包含两行，第一行是一个数字0或1。0代表明明不能完成任务，1代表明明能完成任务。    第二行为一个整数a，第一行输出0则a代表最多可完成a个环节，第一行输出1则a代表完成任务至少需要花费的费用。
</pre>
  
  
## 样例输入：  

<pre>
5 4 3 21 2 12 3 13 4 14 5 11 103 10        5 1002 4  

</pre>
  
  
## 样例输出：  

<pre>
1141  

</pre>
  
  
## 数据范围及提示：  

<pre>
样例解释   从2-1-2-3-4-5花费最小，为20+10+10+1+100=141.  
数据范围对于10%的数据，第一行输出0。对于另10%的数据，k=p=1。对于100%的数据，1≤n≤10000；1≤m≤50000；1≤k≤100；1≤p≤10。对于100%的数据，保证数据及答案不超过maxlongint。  
  

</pre>
  
  
***  

##### AC: 4  
##### WA: 2  
##### TLE: 3  
##### MLE: 0  
##### RE: 0  
