# 2273 扬帆远洋大战牧师妹酱   
### 时间限制： 1 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 32000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 大师  
## 题目描述：  

<pre>
扬帆远洋为了打败牧师妹酱，不惜一切代价通过各种各样的手段得到了传奇道具“れいじまいご”来释放能量使得全球充满扬帆远洋的威严气场和能量场。但是，“れいじまいご”释放的能量只能在某个很小的区域中存在，为了使得效果可以逸散的全球，扬帆远洋决定效仿心灵操控者——尤里，在世界各地修建了N个“れいじまいご·ベクトル変換”使得其能量场可以在全世界张开。
根据计算机的计算结果，这N个地点大多都是非常偏僻的城镇。因此，之间的道路并不定都是畅通的。这些地区之间通过R条道路连接，为了使得之间前往的方便，扬帆远洋TEL还帮助扬帆远洋产生了P个空间隧道，扬帆远洋称之为“時間と空間の扉”。每条道路i或者“時間と空間の扉”i连接地区Ai到Bi，花费为Ci。道路是双向的，可以从Ai到Bi，也可以从Bi到Ai，花费都是Ci。然而“時間と空間の扉”与之不同，只可以从Ai到Bi。事实上，由于牧师妹酱的墨镜党(看看我的头像就知道了)的不断干扰使得链接非常不稳定。牧师妹酱的墨镜党的干扰如下：如果有一条“時間と空間の扉”可以从Ai到Bi，那么保证不可能通过一些道路和“時間と空間の扉”从Bi回到Ai。所以有些地区可能无法到达，需要扬帆远洋对自己进行Teleport才可以。
扬帆远洋现在呆在S城镇，由于他需要把每个“れいじまいご·ベクトル変換”的装置调整完毕，因此扬帆远洋写了一个程序计算从S出发，对于每个地区而言计算出了最小的花费，如果不可能，则输出“Need Teleport To Repair”。最后输出，一共有多少个地方是需要用Teleport的。
但是由于墨镜党不断的捣乱，这个程序现在无法工作，请你复述出来这个程序。
</pre>
  
  
## 输入描述：  

<pre>
第1行有四个空格隔开的整数T、R、P和S。  
第2至R+1行每行有3个空格隔开的正整数，表示一条道路的Ai、Bi和Ci。  
第R+2至R+P+1行每行有3个空格隔开的正整数，表示一条“時間と空間の扉”的Ai、Bi和Ci。
</pre>
  
  
## 输出描述：  

<pre>
第1到T行每行输出的是从S到达地区i的最小花费，如果不存在输出“Need Teleport To Repair”（没有引号）。最后一行为一共有多少个地方是需要用Teleport的。
</pre>
  
  
## 样例输入：  

<pre>
6 3 3 4  
1 2 5  
3 4 5  
5 6 10  
3 5 -100  
4 6 -100  
1 3 -10
</pre>
  
  
## 样例输出：  

<pre>
Need Teleport To Repair  
Need Teleport To Repair  
5  
0  
-95  
-100  
2
</pre>
  
  
## 数据范围及提示：  

<pre>
1≤T≤25000，1≤R≤50000，1≤P≤50000，1≤S≤T  
1≤Ai≤T，1≤Bi≤T，-10000≤Ci≤10000（对于“時間と空間の扉”来说花费才可能是负数）
牧师妹酱, 扬帆远洋, 扬帆远洋TEL均为真实存在的人物.
故事取材于大B吧奇幻史, 可以查看Bilibili上的一个视频:<a href="http://www.bilibili.tv/video/av441478/">http://www.bilibili.tv/video/av441478/</a>
题目修改自USACO
</pre>
  
  
***  

##### AC: 32  
##### WA: 29  
##### TLE: 48  
##### MLE: 0  
##### RE: 13  
