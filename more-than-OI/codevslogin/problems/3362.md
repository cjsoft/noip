# 3362 骑士游戏   
### 时间限制： 3 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 256000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 大师  
## 题目描述：  

<pre>
长期的宅男生活中，JYY又挖掘出了一款RPG游戏。在这个游戏中JYY会扮演一个英勇的骑士，用他手中的长剑去杀死入侵村庄的怪兽。 
在这个游戏中，JYY一共有两种攻击方式，一种是普通攻击，一种是法术攻击。两种攻击方式都会消耗JYY一些体力。 
采用普通攻击进攻怪兽并不能把怪兽彻底杀死，怪兽的尸体可以变出其他一些新的怪兽，注意一个怪兽可能经过若干次普通攻击后变回一个或更多同样的怪兽；而采用法术攻击则可以彻底将一个怪兽杀死。当然了，一般来说，相比普通攻击，法术攻击会消耗更多的体力值（但由于游戏系统bug，并不保证这一点）。 
游戏世界中一共有N种不同的怪兽，分别由1到N编号，现在1号怪兽入侵村庄了，JYY想知道，最少花费多少体力值才能将所有村庄中的怪兽全部杀死呢？
</pre>
  
  
## 输入描述：  

<pre>
第一行包含一个整数N。 
接下来N行，每行描述一个怪兽的信息； 
其中第i行包含若干个整数，前三个整数为Si ，Ki 和Ri ，表示对于i号怪兽，普通攻击需要消耗Si 的体力，法术攻击需要消耗Ki 的体力，同时i号怪兽死亡后会产生 Ri个新的怪兽。接下来 Ri个1到N之间的整数，表示一个新出现的怪兽编号。同一编号的怪兽可以出现多个。
</pre>
  
  
## 输出描述：  

<pre>
输出一行一个整数，表示最少需要的体力值。
</pre>
  
  
## 样例输入：  

<pre>
4 
4 27 3 2 3 2 
3 5 1 2 
1 13 2 4 2 
5 6 1 2
</pre>
  
  
## 样例输出：  

<pre>
26
</pre>
  
  
## 数据范围及提示：  

<pre>

N≤200,000；Ki，Si≤5*10^14

</pre>
  
  
***  

##### AC: 27  
##### WA: 43  
##### TLE: 21  
##### MLE: 0  
##### RE: 21  
