# 4375 xdz的难题   
### 时间限制： 2 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 256000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 大师  
## 题目描述：  

<pre>
xdz 觉得树是一种非常神秘、美妙的东西。所以他提出了一个他  
认为无人能做的题目给你一棵初始根为 1 的有根树,每个节点有一个  
权值让你维护以下几个操作。  
1、将树根换为 x  
2、将一个节点权值改为 v  
3、询问一个子树中的所有节点的最小值。  

</pre>
  
  
## 输入描述：  

<pre>
第 1 行两个数 n,T, 表示树的节点个数和操作总数  
接下来 n 行,  
第 i 行两个数 x,y,表示 i 结点的父亲为 x,权值为 y。节点 1 的  
父亲为 0,且保证开始时每个节点的父亲标号小于他自己。  
在接下来 T 行  
每行第一个读入一个字符 opt 表示操作类型  
opt  
如果 opt=“E”,再读入一个数 x,表示将树的根节点换为 x。  
如果 opt=“V”,再读入两个数 x,v,表示将标号 x 节点值换为 v。  
如果 opt=“Q”,再读入一个数 x,表示询问 x 节点为根的子树。  

</pre>
  
  
## 输出描述：  

<pre>
若干行,依次表示对每个询问的回答。
</pre>
  
  
## 样例输入：  

<pre>
3 80 11 21 3Q 1V 1 6Q 1V 2 5Q 1V 3 4E 3Q 1  

</pre>
  
  
## 样例输出：  

<pre>
1235  

</pre>
  
  
## 数据范围及提示：  

<pre>
测试点  
1、2 数据规模n<=1000,T<=1000   
3、4 n<=100000,T<=100000 树为一条链  
5、6、7、8 n<=100000,T<=100000 树的形态随机,换根操作个数不超过 20  
9、10 n<=100000,T<=100000 没有换根操作  
11、12 n<=200000,T<=200000 没有换根操作  
13、14 n<=100000,T<=100000 无  
15、16 n<=200000,T<=200000 无  
17、18 n<=500000,T<=500000 无  
19、20 n<=1000000,T<=1000000 无所有权值不超过long long，且为正整数  

</pre>
  
  
***  

##### AC: 3  
##### WA: 0  
##### TLE: 3  
##### MLE: 0  
##### RE: 1  
