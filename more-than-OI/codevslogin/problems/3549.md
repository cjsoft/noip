# 3549 Mimori与树海   
### 时间限制： 1 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 128000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 大师  
## 题目描述：  

<pre>
Mimori知道了，只有毁灭掉神树，才能保护Yuuna和大家。但是，想要到神树那里需要穿越树海，树海非常危险，需要携带一定量的精灵才能通过。她把树海抽象为一张有n个点和m条边的无向连通图，无重边和自环(三无图)，结点编号为1~n，结点之间有双向道路连接。每个结点有一个精灵需求数，u结点的精灵需求数记作w[u]。通过这些边要支付一定数量的精灵！费用规定如下：①若是普通道路(记作类别0)，她需要支付1只精灵。②若是特殊道路(记作类别1)，她需要支付自己当前携带的精灵数的1/20，若不满20只则按20只计算。(例如、若她身上此时有10只精灵，则需要支付1只；若有69只精灵，则需要支付4只。)她定义了一个整数S，令S等于每对结点之间的最优路径长度之和。我们用d(u,v)表示u,v之间的最优路径长度，d(u,v)被定义为从u沿路径到达v，且身上至少还有w[v]只精灵的前提下，初始携带的的最少精灵数(注意!仅仅在边上要支付精灵,在结点处不支付,但是你需要满足终点的精灵需求数)。(例如、结点数等于3时，S=d(1,1)+d(1,2)+d(1,3)+d(2,1)+d(2,2)+d(2,3)+d(3,1)+d(3,2)+d(3,3))那么问题来了，她想删除一条边后使得新的S值S’最大。当然，你必须保证删除后图仍然连通才行。  

</pre>
  
  
## 输入描述：  

<pre>
第一行包括2个整数n，m，分别表示图的顶点数和边数。第二行包括n个整数w1...wn，表示n个结点的精灵需求数。接下来m行，每行包括三个整数u，v，op，代表一条连接u、v的无向边，其类别为op(参见题目描述)。保证图连通，且无重边和自环。  

</pre>
  
  
## 输出描述：  

<pre>
仅包含一行，包括2个整数，为S和最大的S’。
</pre>
  
  
## 样例输入：  

<pre>
【输入样例1】5 615 14 10 14 121 2 02 3 03 4 12 5 13 5 13 1 1  
【输入样例2】20 4019 78 16 89 1 19 85 18 44 36 69 56 50 30 60 100 31 70 8 131 2 11 3 02 4 14 5 04 6 01 7 03 8 08 9 17 10 12 11 15 12 03 13 010 14 02 15 14 16 03 17 08 18 011 19 112 20 015 8 110 9 12 13 013 4 014 15 17 14 015 18 13 19 16 9 111 7 020 14 15 7 016 10 112 19 119 14 18 11 015 20 016 17 019 7 05 19 08 5 0  

</pre>
  
  
## 样例输出：  

<pre>
【输出样例1】353 357  
【输出样例2】18918 19068  

</pre>
  
  
## 数据范围及提示：  

<pre>
1<=n<=110，  
1<=m<=1100，1<=u<=n，1<=v<=n，u≠v，0<=op<=1，1<=wi<=100(1<=i<=n)，保证图连通，且无重边和自环。特殊数据：测试点 n m 备注0 <=5 <=8 op=01 <=5 <=8 op=02 <=70 <=140 op=03 <=70 <=140 op=04 <=70 <=1405 <=70 <=1406 <=110 <=11007 <=110 <=11008 <=110 <=11009 <=110 <=1100  

</pre>
  
  
***  

##### AC: 3  
##### WA: 8  
##### TLE: 1  
##### MLE: 0  
##### RE: 0  
