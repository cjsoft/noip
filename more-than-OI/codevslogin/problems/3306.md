# 3306 水果姐逛水果街Ⅲ   
### 时间限制： 2 s     空间限制： 256000 KB     题目等级： 大师  
## 题目描述：  

<pre>
连续两天都没有被cgh难倒，水果姐心情很不错，第三天又来逛水果街。
今天cgh早早就来到了水果街等水果姐，因为他带来了帮手cys。cgh的魔法是把水果街变成树结构，而cys的魔法是瞬间改变某家店的水果价格。一边问一边改，绝不给水果姐思考的时间！
同样还是n家水果店，编号为1~n，每家店能买水果也能卖水果，并且同一家店卖与买的价格一样。
cgh和cys一共有m个操作。
操作的格式为
0 x y 获 1 x y
如果操作类型是0，表示cys把第x家店的价格改为y
如果操作类型是1，则表示要求水果姐从第x家店出发到第y家店，途中只能选一家店买一个水果，然后选一家店（可以是同一家店，但不能往回走）卖出去。并且输出最多可以赚多少钱。
这题是给天牛做的。
</pre>
  
  
## 输入描述：  

<pre>
第一行n，表示有n家店
下来n个正整数，表示每家店一个苹果的价格。
下来n-1行，每行两个整数x，y，表示第x家店和第y家店有一条边。
下来一个整数m，表示下来有m个操作。
下来有m行，每行三个整数，表示一次操作。
</pre>
  
  
## 输出描述：  

<pre>
每行对应一个1类型的操作，输出一个整数，表示面对cgh的每次询问，水果姐最多可以赚到多少钱。
</pre>
  
  
## 样例输入：  

<pre><code>
4  
16 5 1 15  
1 2  
1 3  
2 4  
3  
1 3 4  
0 3 17  
1 4 3
</code></pre>
  
  
## 输出输出：  

<pre><code>
15  
12
</code></pre>
  
  
## 数据范围及提示：  

<pre>
0<=苹果的价格<=10^8
0<n<=2*10^5
0<m<=10^5
</pre>
  
  
***  

##### AC: 42  
##### WA: 30  
##### TLE: 10  
##### MLE: 0  
##### RE: 5  
