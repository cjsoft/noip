# 1391 伊吹萃香   
### 时间限制： 1 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 128000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 黄金  
## 题目描述：  

<pre>
在幻想乡，伊吹萃香是能够控制物体密度的鬼王。因为能够控制密度，所以萃香能够制造白洞和黑洞，并可以随时改变它们。某一天萃香闲着无聊，在妖怪之山上设置了一些白洞或黑洞，由于引力的影响，给妖怪们带来了很大的麻烦。于是他们决定找出一条消耗体力最少的路，来方便进出。已知妖怪之山上有N个路口(编号1..N)，每个路口都被萃香设置了一定质量白洞或者黑洞。原本在各个路口之间有M条单向路，走过每一条路需要消耗一定量的体力以及1个单位的时间。由于白洞和黑洞的存在，走过每条路需要消耗的体力也就产生了变化，假设一条道路两端路口黑白洞的质量差为delta：
1. 从有白洞的路口走向有黑洞的路口，消耗的体力值减少delta，若该条路径消耗的体力值变为负数的话，取为0。
2. 从有黑洞的路口走向有白洞的路口，消耗的体力值增加delta。
3. 如果路口两端均为白洞或黑洞，消耗的体力值无变化。
由于光是放置黑洞白洞不足以体现萃香的强大，所以她决定每过1个单位时间，就把所有路口的白洞改成黑洞，黑洞改成白洞。当然在走的过程中你可以选择在一个路口上停留1个单位的时间，如果当前路口为白洞，则不消耗体力，否则消耗s[i]的体力。现在请你计算从路口1走到路口N最小的体力消耗。保证一定存在道路从路口1到路口N。
</pre>
  
  
## 输入描述：  

<pre>
第1行：2个正整数N, M
第2行：N个整数，第i个数为0表示第i个路口开始时为白洞，1表示黑洞
第3行：N个整数，第i个数表示第i个路口设置的白洞或黑洞的质量w[i]
第4行：N个整数，第i个数表示在第i个路口停留消耗的体力s[i]
第5..M+4行：每行3个整数，u, v, k，表示在没有影响的情况下，从路口u走到路口v需要消耗k的体力。
</pre>
  
  
## 输出描述：  

<pre>
第1行：1个整数，表示消耗的最小体力
</pre>
  
  
## 样例输入：  

<pre>
4 5
1 0 1 0
10 10 100 10
5 20 15 10
1 2 30
2 3 40
1 3 20
1 4 200
3 4 200
</pre>
  
  
## 样例输出：  

<pre>
130
</pre>
  
  
## 数据范围及提示：  

<pre>
对于30%的数据：1 <= N <= 100, 1 <= M <= 500
对于60%的数据：1 <= N <= 1,000, 1 <= M <= 5,000
对于100%的数据：1 <= N <= 5,000, 1 <= M <= 30,000
其中20%的数据为1 <= N <= 3000的链
1 <= u,v <= N, 1 <= k,w[i],s[i] <= 200
按照1 -> 3 -> 4的路线。
</pre>
  
  
***  

##### AC: 48  
##### WA: 79  
##### TLE: 12  
##### MLE: 0  
##### RE: 21  
