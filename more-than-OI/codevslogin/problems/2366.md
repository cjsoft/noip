# 2366 朋友圈    
### 时间限制： 10 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 256000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 大师  
## 题目描述：  

<pre>
在很久很久以前，曾经有两个国家和睦相处，无忧无虑的生活着。   
一年一度的评比大会开始了，作为和平的两国，一个朋友圈数量最多的永远都是最值得  
他人的尊敬，所以现在就是需要你求朋友圈的最大数目。   
两个国家看成是 AB 两国，现在是两个国家的描述：   
1、 A 国：每个人都有一个友善值，当两个 A 国人的友善值 a、b，如果 a xor b mod 2=1，  
那么这两个人都是朋友，否则不是；   
2、 B 国：每个人都有一个友善值，当两个 B 国人的友善值 a、b，如果 a xor b mod 2=0  
或者 (a or b)化成二进制有奇数个 1，那么两个人是朋友，否则不是朋友；   
3、 A、B 两国之间的人也有可能是朋友，数据中将会给出 A、B之间“朋友”的情况。
4、 对于朋友的定义，关系是是双向的。   
在 AB 两国，朋友圈的定义：一个朋友圈集合 S，满足   
S属于A并B，对于所有的 i，j属于S，i 和 j是朋友   
由于落后的古代，没有电脑这个也就成了每年最大的难题，而你能帮他们求出最大朋  
友圈的人数吗？
</pre>
  
  
## 输入描述：  

<pre>
第一行 t<=6,表示输入数据总数。   
接下来 t 个数据：   
 第一行输入三个整数 A,B,M，表示A国人数、B 国人数、AB 两国之间是朋友的对数；   
 第二行 A 个数 ai，表示A 国第i 个人的友善值；   
 第三行 B 个数 bi，表示B 国第j 个人的友善值；   
 第 4——3+M行，每行两个整数（i，j） ，表示第i 个A 国人和第 j 个B 国人是朋友。
</pre>
  
  
## 输出描述：  

<pre>
 输出 t 行，每行，输出一个整数，表示最大朋友圈的数目。 
</pre>
  
  
## 样例输入：  

<pre>
1   
2 4 7   
1 2   
2 6 5 4   
1 1   
1 2   
1 3   
2 1   
2 2   
2 3   
2 4
</pre>
  
  
## 样例输出：  

<pre>
5 
</pre>
  
  
## 数据范围及提示：  

<pre>
对于其中 30%的数据，A=0，B<=100；   
对于其中 50%的数据，A<=10，B<=100；   
对于其中 10%的数据，A<=5，B<=1000；   
对于其中 10%的数据，A<=5，B<=1500；   
对于 100%的数据，M<=A*B，友善值在2^30 以内。
</pre>
  
  
***  

##### AC: 4  
##### WA: 0  
##### TLE: 7  
##### MLE: 2  
##### RE: 12  
