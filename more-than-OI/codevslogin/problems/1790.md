# 1790 神奇口袋    
### 时间限制： 1 s&nbsp;&nbsp;&nbsp;&nbsp;空间限制： 128000 KB&nbsp;&nbsp;&nbsp;&nbsp;题目等级： 大师  
## 题目描述：  

<pre>
Pòlya 获得了一个奇妙的口袋，上面写着人类难以理解的符号。Pòlya 看得入 了迷，冥思苦想，发现了一个神奇的模型（被后人称为 Pòlya 模型)。为了生动 地讲授这个神奇的模型，他带着学生们做了一个虚拟游戏：   
游戏开始时，袋中装入 a1个颜色为 1 的球，a2个颜色为 2 的球，…，at 个颜色为 t 的球，其中ai是正整数。   
游戏开始后，每次严格进行如下的操作：   
从袋中随机的抽出一个小球（袋中所有小球被抽中的概率相等）， Pòlya 独自观察这个小球的颜色后将其放回 ，然后再把 d 个与其颜色相同 的小球放到口袋中。   
设 ci表示第 i 次抽出的小球的颜色  (1≤c i≤  t )，一个游戏过程将会产生一个颜 色序列(c1,c2,…,cn,…)。 Pòlya 把游戏开始时 t 种颜色的小球每一种的个数 a1,a2,…,at 告诉了所有学 生。然后他问学生：一次游戏过程产生的颜色序列满足下列条件的概率有多大？
其中 0<x1<x2<…<xn ， 1≤yi≤t 。换句话说，已知(t , n , d , a1,a2,…,at , x1,y1,x2,y2,...,xn,yn)，你要回答有多大的可能性会发生下面的事件：“对所有 k,1≤k≤n，第 xk次抽出的球的颜色为 yk”。 

</pre>
  
  
## 输入描述：  

<pre>
第一行有三个正整数 t，n，d ；  
第二行有 t 个正整数 a1,a2,…,at，表示游戏开 始时口袋里 t 种颜色的球，每种球的个数。   
以下 n 行，每行有两个正整数 xi,yi，表示第 xi次抽出颜色为的 yi球。
</pre>
  
  
## 输出描述：  

<pre>
要求用分数形式输出（显然此概率为有理数）。输出文件包含一行，格式为： 分子/分母。同时要求输出最简形式（分子分母互质）。特别的，概率为 0 应输出0/1，概率为 1 应输出 1/1。
 

</pre>
  
  
## 样例输入：  

<pre>
样例 1 的输入
2 3 1
1 1
1 1
2 2
3 1 
样例 2 的输入
3 1 2
1 1 1
5 1
</pre>
  
  
## 样例输出：  

<pre>
样例 1 的输出  1/12 
样例 2 的输出  1/3
</pre>
  
  
## 数据范围及提示：  

<pre>
1≤t,n≤1000, 1≤ak ,d≤10, 1≤x1<x2<…<xn≤10000, 1≤yk≤t
【样例 1 说明】   
初始时，两种颜色球数分别为(1, 1)，取出色号为 1 的球的概率为 1/2；第二 次取球之前，两种颜色球数分别为(2, 1)，取出色号为 2 的球的概率为 1/3；第三 次取球之前，两种颜色球数分别为(2, 2)，取出色号为 1 的球的概率为 1/2，所以 三次取球的总概率为 1/12。
</pre>
  
  
***  

##### AC: 27  
##### WA: 12  
##### TLE: 1  
##### MLE: 0  
##### RE: 1  
